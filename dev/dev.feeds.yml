# Global middleware (applies to all feeds in order)
# Scripts are loaded from the middleware directory specified via --middleware-dir
middleware:
  - "logger.lua"
  - "rate_limit.lua"

# Feed definitions
feeds:
  - name: "Production Alerts"
    slug: "prod-alerts"
    description: "Critical production alerts from monitoring systems"

    middleware:
      - "enrich_alerts.lua"
      - "severity_mapper.lua"

    adapters:
      - "discord@v2"

    retention:
      maxCount: 10000
      maxAgeDays: 90

  - name: "GitHub Events"
    slug: "github"
    description: "GitHub webhook events (push, PR, issues, etc.)"

    middleware:
      - "github_formatter.lua"

    # Empty array = auto-detect adapter
    adapters: []

    retention:
      maxCount: 5000
      maxAgeDays: 30

  - name: "Internal Notifications"
    slug: "secret-internal-notifications-key-123"
    description: "Internal system notifications (slug is used as secret key)"

    # No middleware for this feed
    middleware: []

    # Null = no adapters (raw mode)
    adapters: null

    retention:
      maxAgeDays: 7

  - name: "Development Testing"
    slug: "dev-test"
    description: "Feed for development and testing purposes"

    # Test with multiple adapters (tried in order)
    adapters:
      - "discord@v2"
      - "ntfy@v1"

    retention:
      maxCount: 100
      maxAgeDays: 1
