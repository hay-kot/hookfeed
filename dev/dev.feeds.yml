# Global middleware (applies to all feeds in order)
# Scripts are loaded from the middleware directory specified via --middleware-dir
middleware:
  - "logger.lua"
  - "rate_limit.lua"

# Feed definitions
feeds:
  - name: "Production Alerts"
    id: "prod-alerts"
    keys:
      - 1ftyjSfiZott986g1rWykD # github
      - KcvgA8pwwmY3XZgEAO4KX3 # discord
    description: "Critical production alerts from monitoring systems"

    middleware:
      - "enrich_alerts.lua"
      - "severity_mapper.lua"

    adapters:
      - "discord@v2"

    retention:
      maxCount: 10000
      maxAgeDays: 90

  - name: "GitHub Events"
    id: "github-events"
    keys:
      - 1ftyjSfiZott983g1rWykD # github
      - KcvgA8pwwmY3XZ1EAO4KX3 # discord
    description: "GitHub webhook events (push, PR, issues, etc.)"

    middleware:
      - "github_formatter.lua"

    # Empty array = auto-detect adapter
    adapters: []

    retention:
      maxCount: 5000
      maxAgeDays: 30

  - name: "Development Testing"
    slug: "dev-test"
    keys:
      - 3ftyjSfiZott983g1rWykD # github
      - fcvgA8pwwmY3XZ1EAO4KX3 # discord
    description: "Feed for development and testing purposes"

    # Test with multiple adapters (tried in order)
    adapters:
      - "discord@v2"
      - "ntfy@v1"

    retention:
      maxCount: 100
      maxAgeDays: 1
